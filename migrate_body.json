{
    "query": "CREATE TABLE IF NOT EXISTS presupuesto_items (id UUID DEFAULT gen_random_uuid() PRIMARY KEY, id_presupuesto INT NOT NULL, linea INT, id_articulo TEXT, descripcion TEXT, cantidad INT DEFAULT 1, importe_unitario NUMERIC(14,2) DEFAULT 0, importe_total NUMERIC(14,2) DEFAULT 0, importe_cobrado NUMERIC(14,2) DEFAULT 0, created_at TIMESTAMPTZ DEFAULT NOW()); ALTER TABLE presupuesto_items DROP CONSTRAINT IF EXISTS uq_presupuesto_item; ALTER TABLE presupuesto_items ADD CONSTRAINT uq_presupuesto_item UNIQUE (id_presupuesto, id_articulo, linea); CREATE INDEX IF NOT EXISTS idx_presupuesto_items_presupuesto ON presupuesto_items(id_presupuesto); ALTER TABLE presupuesto_items ENABLE ROW LEVEL SECURITY; DROP POLICY IF EXISTS allow_all_presupuesto_items ON presupuesto_items; CREATE POLICY allow_all_presupuesto_items ON presupuesto_items FOR ALL USING (true) WITH CHECK (true);"
}